<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Prayer Tracker - WellNest</title>
  <link rel="stylesheet" href="style.css?v=20241005">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="images/fitness-logo.svg" alt="WellNest Logo" class="logo">
        <span>WellNest</span>
      </div>
      
      <ul class="nav-menu" id="navMenu">
        <li><a href="index.html">Home</a></li>
        <li><a href="body.html">Body</a></li>
        <li><a href="bodyhealth.html">Body Health</a></li>
        <li><a href="mind.html">Mind</a></li>
        <li><a href="sleep.html">Sleep</a></li>
        <li><a href="diet.html">Diet</a></li>
        <li><a href="workout.html">Workout</a></li>
        <li><a href="pray.html" class="active">Pray</a></li>
        <li><a href="care.html">Care</a></li>
        <li><a href="reminders.html">Reminders</a></li>
        <li id="loginLink"><a href="login.html">Login</a></li>
        <li id="signupLink"><a href="signup.html">Sign Up</a></li>
      </ul>
      
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      <h1 class="page-title">üïå Prayer Tracker</h1>
      
      <!-- Prayer Progress Card -->
      <div class="care-card prayer-progress-card">
        <h3>üåô Today's Prayer Progress</h3>
        <div class="prayer-stats">
          <div class="stat-circle">
            <span id="prayerCount">0</span>
            <small>out of 5</small>
          </div>
          <div class="completion-text">
            <p id="prayerStatus">Start your spiritual journey today</p>
            <div class="progress-container">
              <div class="progress-bar">
                <div class="progress-fill" id="prayerProgress"></div>
              </div>
              <span class="progress-percentage" id="progressPercentage">0%</span>
            </div>
          </div>
        </div>
        
        <!-- Five Daily Prayers -->
        <div class="prayer-list">
          <div class="prayer-item">
            <label class="prayer-checkbox">
              <input type="checkbox" id="fajr" onchange="updatePrayerProgress()">
              <span class="checkmark">üåÖ</span>
              <div class="prayer-info">
                <span class="prayer-name">Fajr</span>
                <span class="prayer-time">Dawn Prayer (5:30 AM)</span>
              </div>
            </label>
          </div>

          <div class="prayer-item">
            <label class="prayer-checkbox">
              <input type="checkbox" id="dhuhr" onchange="updatePrayerProgress()">
              <span class="checkmark">‚òÄÔ∏è</span>
              <div class="prayer-info">
                <span class="prayer-name">Dhuhr</span>
                <span class="prayer-time">Noon Prayer (12:15 PM)</span>
              </div>
            </label>
          </div>

          <div class="prayer-item">
            <label class="prayer-checkbox">
              <input type="checkbox" id="asr" onchange="updatePrayerProgress()">
              <span class="checkmark">üåá</span>
              <div class="prayer-info">
                <span class="prayer-name">Asr</span>
                <span class="prayer-time">Afternoon Prayer (3:45 PM)</span>
              </div>
            </label>
          </div>

          <div class="prayer-item">
            <label class="prayer-checkbox">
              <input type="checkbox" id="maghrib" onchange="updatePrayerProgress()">
              <span class="checkmark">üåÜ</span>
              <div class="prayer-info">
                <span class="prayer-name">Maghrib</span>
                <span class="prayer-time">Sunset Prayer (6:20 PM)</span>
              </div>
            </label>
          </div>

          <div class="prayer-item">
            <label class="prayer-checkbox">
              <input type="checkbox" id="isha" onchange="updatePrayerProgress()">
              <span class="checkmark">üåô</span>
              <div class="prayer-info">
                <span class="prayer-name">Isha</span>
                <span class="prayer-time">Night Prayer (7:45 PM)</span>
              </div>
            </label>
          </div>
        </div>
      </div>

      <!-- Islamic Habits Tracker -->
      <div class="care-card habits-card" style="background: linear-gradient(135deg, #79C9AF 0%, #A8E6CF 100%); color: #2C6E63; box-shadow: 0 6px 25px rgba(121, 201, 175, 0.3);">
        <h3>üåü Islamic Habits Today</h3>
        <div class="habits-grid">
          <div class="habit-item">
            <label class="habit-checkbox">
              <input type="checkbox" id="quran" onchange="updateHabitProgress()">
              <span class="habit-icon">üìñ</span>
              <span class="habit-name">Read Quran</span>
            </label>
          </div>

          <div class="habit-item">
            <label class="habit-checkbox">
              <input type="checkbox" id="dhikr" onchange="updateHabitProgress()">
              <span class="habit-icon">üìø</span>
              <span class="habit-name">Dhikr/Tasbih</span>
            </label>
          </div>

          <div class="habit-item">
            <label class="habit-checkbox">
              <input type="checkbox" id="dua" onchange="updateHabitProgress()">
              <span class="habit-icon">ü§≤</span>
              <span class="habit-name">Make Dua</span>
            </label>
          </div>

          <div class="habit-item">
            <label class="habit-checkbox">
              <input type="checkbox" id="charity" onchange="updateHabitProgress()">
              <span class="habit-icon">üíù</span>
              <span class="habit-name">Give Charity</span>
            </label>
          </div>

          <div class="habit-item">
            <label class="habit-checkbox">
              <input type="checkbox" id="istighfar" onchange="updateHabitProgress()">
              <span class="habit-icon">üôè</span>
              <span class="habit-name">Istighfar</span>
            </label>
          </div>

          <div class="habit-item">
            <label class="habit-checkbox">
              <input type="checkbox" id="sunnah" onchange="updateHabitProgress()">
              <span class="habit-icon">‚ú®</span>
              <span class="habit-name">Sunnah Acts</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Weekly Prayer History -->
      <div class="care-card weekly-prayer-card" style="background: linear-gradient(135deg, #A8E6CF 0%, #79C9AF 100%); color: #2C6E63; box-shadow: 0 6px 25px rgba(168, 230, 207, 0.3);">
        <h3>üìä Weekly Prayer History</h3>
        <div class="weekly-stats">
          <div class="week-summary">
            <div class="weekly-count">
              <span id="weeklyTotal">0</span>
              <small>prayers this week</small>
            </div>
            <div class="weekly-percentage">
              <span id="weeklyPercentage">0%</span>
              <small>completion rate</small>
            </div>
          </div>
          <div class="weekly-calendar" id="weeklyCalendar">
            <!-- Days will be populated by JavaScript -->
          </div>
        </div>
      </div>

      <!-- Spiritual Reminders -->
      <div class="care-card reminders-card" style="background: linear-gradient(135deg, #79C9AF 0%, #A8E6CF 100%); color: #2C6E63; box-shadow: 0 6px 25px rgba(121, 201, 175, 0.3);">
        <h3>üí´ Daily Spiritual Reminders</h3>
        <div class="reminder-list">
          <div class="reminder-item">
            <span class="reminder-icon">üïê</span>
            <p>Remember Allah at all times - "And remember your Lord much and exalt Him with praise in the evening and the morning." (Quran 3:41)</p>
          </div>
          <div class="reminder-item">
            <span class="reminder-icon">‚ù§Ô∏è</span>
            <p>Purify your heart - "The day when wealth and children will not benefit [anyone], but only one who comes to Allah with a sound heart." (Quran 26:88-89)</p>
          </div>
          <div class="reminder-item">
            <span class="reminder-icon">ü§ù</span>
            <p>Be kind to others - "And whoever does good deeds, whether male or female, and is a believer - such will enter Paradise." (Quran 4:124)</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Get today's date key
    const today = new Date();
    const todayKey = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
    
    console.log('üìÖ Today:', todayKey);

    // Initialize prayer system
    function initializePrayerSystem() {
      // Ensure localStorage structure exists
      if (!localStorage.getItem('wellnest_user')) {
        localStorage.setItem('wellnest_user', 'true');
      }

      let userData = JSON.parse(localStorage.getItem('wellnest_user_data') || '{}');
      
      if (!userData.prayers) userData.prayers = {};
      if (!userData.habits) userData.habits = {};
      
      if (!userData.prayers[todayKey]) {
        userData.prayers[todayKey] = {
          fajr: false,
          dhuhr: false,
          asr: false,
          maghrib: false,
          isha: false
        };
      }

      if (!userData.habits[todayKey]) {
        userData.habits[todayKey] = {
          quran: false,
          dhikr: false,
          dua: false,
          charity: false,
          istighfar: false,
          sunnah: false
        };
      }

      localStorage.setItem('wellnest_user_data', JSON.stringify(userData));
      console.log('‚úÖ Prayer system initialized');
      return userData;
    }

    // Update prayer progress
    function updatePrayerProgress() {
      console.log('üîÑ Updating prayer progress...');
      
      const prayers = ['fajr', 'dhuhr', 'asr', 'maghrib', 'isha'];
      let checkedCount = 0;
      
      // Count checked prayers and save state
      let userData = JSON.parse(localStorage.getItem('wellnest_user_data') || '{}');
      
      prayers.forEach(prayer => {
        const checkbox = document.getElementById(prayer);
        if (checkbox && checkbox.checked) {
          checkedCount++;
        }
        // Save individual prayer state
        if (userData.prayers && userData.prayers[todayKey]) {
          userData.prayers[todayKey][prayer] = checkbox ? checkbox.checked : false;
        }
      });

      // Save updated data
      localStorage.setItem('wellnest_user_data', JSON.stringify(userData));
      
      // Update UI
      updatePrayerUI(checkedCount);
      updateWeeklyHistory();
      
      console.log('‚úÖ Prayer progress updated - Count:', checkedCount);
    }

    // Update prayer UI elements
    function updatePrayerUI(count) {
      const percentage = Math.round((count / 5) * 100);
      
      // Update count
      const countElement = document.getElementById('prayerCount');
      if (countElement) {
        countElement.textContent = count;
      }

      // Update progress bar
      const progressElement = document.getElementById('prayerProgress');
      if (progressElement) {
        progressElement.style.width = percentage + '%';
        console.log('üìä Progress bar width set to:', percentage + '%');
      }

      // Update percentage text
      const percentageElement = document.getElementById('progressPercentage');
      if (percentageElement) {
        percentageElement.textContent = percentage + '%';
      }

      // Update status message
      const statusElement = document.getElementById('prayerStatus');
      if (statusElement) {
        let status = '';
        if (count === 0) {
          status = 'Start your spiritual journey today üåü';
        } else if (count === 1) {
          status = 'Great start! Continue with your prayers üí´';
        } else if (count === 2) {
          status = 'Good progress! Keep it up üåô';
        } else if (count === 3) {
          status = 'Excellent! More than halfway there ‚ú®';
        } else if (count === 4) {
          status = 'Almost complete! One more prayer üåü';
        } else if (count === 5) {
          status = 'Mashallah! All prayers completed today üéâ';
        }
        statusElement.textContent = status;
      }
    }

    // Update habit progress
    function updateHabitProgress() {
      const habits = ['quran', 'dhikr', 'dua', 'charity', 'istighfar', 'sunnah'];
      let userData = JSON.parse(localStorage.getItem('wellnest_user_data') || '{}');
      
      habits.forEach(habit => {
        const checkbox = document.getElementById(habit);
        if (userData.habits && userData.habits[todayKey]) {
          userData.habits[todayKey][habit] = checkbox ? checkbox.checked : false;
        }
      });

      localStorage.setItem('wellnest_user_data', JSON.stringify(userData));
      console.log('‚úÖ Habits updated');
    }

    // Load saved data
    function loadSavedData() {
      console.log('üìñ Loading saved data...');
      
      const userData = JSON.parse(localStorage.getItem('wellnest_user_data') || '{}');
      
      // Load prayer states
      const prayers = ['fajr', 'dhuhr', 'asr', 'maghrib', 'isha'];
      let checkedCount = 0;
      
      if (userData.prayers && userData.prayers[todayKey]) {
        prayers.forEach(prayer => {
          const checkbox = document.getElementById(prayer);
          const savedState = userData.prayers[todayKey][prayer] || false;
          if (checkbox) {
            checkbox.checked = savedState;
            if (savedState) checkedCount++;
          }
        });
      }

      // Load habit states  
      const habits = ['quran', 'dhikr', 'dua', 'charity', 'istighfar', 'sunnah'];
      if (userData.habits && userData.habits[todayKey]) {
        habits.forEach(habit => {
          const checkbox = document.getElementById(habit);
          const savedState = userData.habits[todayKey][habit] || false;
          if (checkbox) {
            checkbox.checked = savedState;
          }
        });
      }

      // Update prayer UI with loaded data
      updatePrayerUI(checkedCount);
      updateWeeklyHistory();
      
      console.log('‚úÖ Data loaded - Prayers:', checkedCount);
    }

    // Update weekly prayer history
    function updateWeeklyHistory() {
      const userData = JSON.parse(localStorage.getItem('wellnest_user_data') || '{}');
      const prayers = userData.prayers || {};
      
      let weeklyTotal = 0;
      let weeklyPossible = 0;
      const weekDays = [];
      
      // Get last 7 days
      for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        
        const dayPrayers = prayers[dateKey] || {};
        const dayCount = ['fajr', 'dhuhr', 'asr', 'maghrib', 'isha'].filter(prayer => dayPrayers[prayer]).length;
        
        weeklyTotal += dayCount;
        weeklyPossible += 5;
        
        weekDays.push({
          date: date,
          dateKey: dateKey,
          count: dayCount,
          percentage: Math.round((dayCount / 5) * 100),
          isToday: dateKey === todayKey
        });
      }
      
      const weeklyPercentage = Math.round((weeklyTotal / weeklyPossible) * 100);
      
      // Update weekly stats
      const weeklyTotalEl = document.getElementById('weeklyTotal');
      const weeklyPercentageEl = document.getElementById('weeklyPercentage');
      
      if (weeklyTotalEl) weeklyTotalEl.textContent = weeklyTotal;
      if (weeklyPercentageEl) weeklyPercentageEl.textContent = weeklyPercentage + '%';
      
      // Update weekly calendar
      const weeklyCalendar = document.getElementById('weeklyCalendar');
      if (weeklyCalendar) {
        weeklyCalendar.innerHTML = weekDays.map(day => {
          const dayName = day.date.toLocaleDateString('en', { weekday: 'short' });
          const dayNum = day.date.getDate();
          
          return `
            <div class="calendar-day ${day.isToday ? 'today' : ''} ${day.count > 0 ? 'completed' : ''}">
              <div class="day-name">${dayName}</div>
              <div class="day-count">${day.count}/5</div>
              <div class="day-percentage">${day.percentage}%</div>
            </div>
          `;
        }).join('');
      }
      
      console.log('üìä Weekly history updated - Total:', weeklyTotal, 'Percentage:', weeklyPercentage + '%');
    }

    // Navigation functions
    function updateNavigation() {
      const isLoggedIn = localStorage.getItem('wellnest_user');
      if (isLoggedIn === 'true') {
        const loginLink = document.getElementById('loginLink');
        const signupLink = document.getElementById('signupLink');
        if (loginLink) loginLink.style.display = 'none';
        if (signupLink) signupLink.style.display = 'none';
      }
    }

    // Hamburger menu
    document.addEventListener('DOMContentLoaded', function() {
      const hamburger = document.getElementById('hamburger');
      const navMenu = document.getElementById('navMenu');

      if (hamburger && navMenu) {
        hamburger.addEventListener('click', () => {
          hamburger.classList.toggle('active');
          navMenu.classList.toggle('active');
        });
      }

      // Initialize everything
      console.log('üöÄ Initializing prayer page...');
      initializePrayerSystem();
      updateNavigation();
      loadSavedData();
      console.log('‚úÖ Prayer page ready!');
    });
  </script>

  <style>
    /* Prayer-specific styles */
    .prayer-progress-card {
      background: linear-gradient(135deg, #A8E6CF 0%, #79C9AF 100%);
      color: #2C6E63;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(121, 201, 175, 0.3);
    }

    .prayer-stats {
      display: flex;
      align-items: center;
      gap: 30px;
      margin-bottom: 30px;
    }

    .stat-circle {
      background: rgba(44, 110, 99, 0.1);
      border: 2px solid rgba(44, 110, 99, 0.3);
      border-radius: 50%;
      width: 80px;
      height: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      color: #2C6E63;
    }

    .stat-circle small {
      font-size: 12px;
      opacity: 0.8;
    }

    .completion-text {
      flex: 1;
    }

    .completion-text p {
      margin: 0 0 15px 0;
      font-size: 16px;
      font-weight: 500;
    }

    .progress-container {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .progress-bar {
      flex: 1;
      height: 12px;
      background: rgba(44, 110, 99, 0.2);
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #00e676, #4caf50);
      border-radius: 6px;
      transition: width 0.5s ease;
      width: 0%;
      box-shadow: 0 2px 10px rgba(0, 230, 118, 0.4);
    }

    .progress-percentage {
      font-weight: bold;
      min-width: 40px;
      text-align: right;
    }

    .prayer-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .prayer-item {
      background: #e8f5e8;
      border-radius: 15px;
      padding: 20px;
      transition: all 0.3s;
      border: 1px solid #c8e6c9;
    }

    .prayer-item:hover {
      background: #dcedc8;
      transform: translateX(10px);
      border-color: #81c784;
      box-shadow: 0 4px 20px rgba(129, 199, 132, 0.3);
    }

    .prayer-checkbox {
      display: flex;
      align-items: center;
      gap: 15px;
      cursor: pointer;
    }

    .prayer-checkbox input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .checkmark {
      font-size: 24px;
    }

    .prayer-info {
      flex: 1;
    }

    .prayer-name {
      display: block;
      font-weight: 600;
      font-size: 18px;
      margin-bottom: 5px;
      color: #2e7d32;
    }

    .prayer-time {
      display: block;
      opacity: 0.8;
      font-size: 14px;
      color: #4a4a4a;
    }

    /* Habits styles */
    .habits-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }

    .habit-item {
      background: #e8f5e8;
      border-radius: 10px;
      padding: 15px;
      transition: all 0.3s;
      border: 1px solid #c8e6c9;
    }

    .habit-item:hover {
      background: #dcedc8;
      border-color: #81c784;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(129, 199, 132, 0.3);
    }

    .habit-checkbox {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
    }

    .habit-checkbox input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .habit-icon {
      font-size: 20px;
    }

    .habit-name {
      font-weight: 500;
      color: #2e7d32;
    }

    /* Reminders styles */
    .reminder-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .reminder-item {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      background: rgba(46, 204, 113, 0.05);
      padding: 15px;
      border-radius: 10px;
      border-left: 4px solid #27ae60;
      transition: all 0.3s;
    }

    .reminder-item:hover {
      background: rgba(46, 204, 113, 0.1);
      border-left-color: #2ecc71;
      transform: translateX(5px);
    }

    .reminder-icon {
      font-size: 24px;
      margin-top: 5px;
    }

    .reminder-item p {
      margin: 0;
      line-height: 1.6;
      color: black;
    }

    /* Additional green theme elements */
    .page-title {
      color: #2C6E63;
      text-shadow: 0 2px 4px rgba(44, 110, 99, 0.3);
    }

    .checkmark {
      transition: all 0.3s;
    }

    .prayer-checkbox input[type="checkbox"]:checked + .checkmark {
      filter: drop-shadow(0 0 8px #00e676);
    }

    .habit-checkbox input[type="checkbox"]:checked + .habit-icon {
      filter: drop-shadow(0 0 6px #27ae60);
    }

    /* Green accent for checked items */
    .prayer-item:has(input:checked) {
      background: #c8e6c9 !important;
      border-color: #4caf50 !important;
      box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3) !important;
    }

    .habit-item:has(input:checked) {
      background: #c8e6c9 !important;
      border-color: #4caf50 !important;
      box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3) !important;
    }

    /* Weekly prayer history styles */
    .weekly-stats {
      margin-top: 20px;
    }

    .week-summary {
      display: flex;
      justify-content: space-around;
      margin-bottom: 25px;
    }

    .weekly-count, .weekly-percentage {
      text-align: center;
      background: rgba(44, 110, 99, 0.1);
      border: 1px solid rgba(44, 110, 99, 0.2);
      padding: 15px;
      border-radius: 10px;
      min-width: 120px;
      color: #2C6E63;
    }

    .weekly-count span, .weekly-percentage span {
      display: block;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .weekly-calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      margin-top: 20px;
    }

    .calendar-day {
      background: rgba(44, 110, 99, 0.1);
      border: 1px solid rgba(44, 110, 99, 0.2);
      border-radius: 8px;
      padding: 10px 5px;
      text-align: center;
      font-size: 12px;
      transition: all 0.3s;
      color: #2C6E63;
    }

    .calendar-day.today {
      background: rgba(44, 110, 99, 0.2);
      border: 2px solid #2C6E63;
    }

    .calendar-day.completed {
      background: rgba(121, 201, 175, 0.3);
      border: 1px solid #79C9AF;
    }

    .day-name {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .day-count {
      font-size: 14px;
      font-weight: bold;
    }

    .day-percentage {
      font-size: 10px;
      opacity: 0.8;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .prayer-stats {
        flex-direction: column;
        text-align: center;
        gap: 20px;
      }

      .progress-container {
        flex-direction: column;
        gap: 10px;
      }

      .habits-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</body>
</html>